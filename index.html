<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="To make a web, iframe url call in a for loop.">
    <meta name="author" content="Colorlib">
    <meta name="keywords" content="To make a web, iframe url call in a for loop.">

    <!-- Open Graph-->
    <meta property="og:title" content="Looping your website">
    <meta property="og:site_name" content="LoopYou">
    <meta property="og:url" content="https://loopyou.github.io/">
    <meta property="og:description" content="To make a iframe looping within a web, repeat and repeat.">
    <meta property="og:type" content="article">
    <meta property="og:image" content="/images/bg-head-02.jpg">

    <!-- Title Page-->
    <title>LoopYou | To make a web looping, repeat and repeat.</title>

    <!-- Icons font CSS-->
    <link href="vendor/mdi-font/css/material-design-iconic-font.min.css" rel="stylesheet" media="all">
    <link href="vendor/font-awesome-4.7/css/font-awesome.min.css" rel="stylesheet" media="all">
    <!-- Font special for pages-->
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i"
        rel="stylesheet">

    <!-- Vendor CSS-->
    <link href="vendor/select2/select2.min.css" rel="stylesheet" media="all">
    <link href="vendor/datepicker/daterangepicker.css" rel="stylesheet" media="all">

    <!-- Main CSS-->
    <link href="css/main.css" rel="stylesheet" media="all">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TBC7RSCKDL"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-TBC7RSCKDL');
    </script>
</head>

<body>
    <div class="page-wrapper bg-blue p-t-100 p-b-100 font-robo">
        <div class="wrapper wrapper--w680">
            <div class="card card-1">
                <div class="card-body">
                    <h1 id='msgTitle'>Loop Url  I ðŸ’– you: </h1>
                    <p id='msg'></p>
                    <p id='msgTotal'></p>
                    <div id='iframeContainer'>
                    </div>
                    <div class='bottomStyle'>
                    </div>
                </div>
            </div>
            <div class="card card-1">
                <div class="card-heading"></div>
                <div class="card-body">
                    <h2 class="title"> URL call in for loop happening in browser iframe?  </h2>

                    <form method="GET" action="/">
                        <div class="input-group">
                            <input class="input--style-1" type="text" placeholder="https://abc.com" id="url" name="url">
                        </div>
                        <div class="input-group">
                            <input class="input--style-1" type="number" placeholder="Max Frame" id="maxFrame"
                                name="maxFrame">
                        </div>
                        <div class="input-group">
                            <input class="input--style-1" type="number" placeholder="Stay Time" id="stayTime"
                                name="stayTime">
                        </div>
                        <div class="p-t-20">
                            <button class="btn btn--radius btn--green" type="submit">Submit</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <script>

        const urlParams = new URLSearchParams(window.location.search);
        const TARGET_URL = urlParams.get('url');
        const stayTime = urlParams.get('stayTime') || 1
        const maxFrame = urlParams.get('maxFrame') || 3
        document.getElementById("url").value = TARGET_URL;
        document.getElementById("stayTime").value = stayTime;
        document.getElementById("maxFrame").value = maxFrame;

        const updateAndShowCount = (msg) => {
            document.getElementById("msg").innerHTML = msg;
        }
        const updateAndShowTotalCount = (msg) => {
            document.getElementById("msgTotal").innerHTML = msg;
        }
        const updateAndShowTitle = (msg) => {
            document.getElementById("msgTitle").innerHTML = msg;
        }

        const appendIFrame = () => {
            const iframe = document.createElement("iframe");
            iframe.src = TARGET_URL;
            iframe.width = "100";
            iframe.height = "100";

            document.getElementById("iframeContainer").appendChild(iframe); //Append iframe to body element
        }

        const removeAllIFrame = () => {
            const iframes = document.querySelectorAll("iframe"); //Get all iframes

            for (const item of iframes) {
                item.parentNode.removeChild(item)
            }
        }

        const sleep = (second = 1) => new Promise((resolve) => {
            setTimeout(() => {
                return resolve()
            }, second * 1000);
        })

        window.onload = async function () {
            let count = 0;
            let total = 0

            updateAndShowTitle(`I love you: ${TARGET_URL}`)

            while (true) {
                await sleep(stayTime)

                if (count >= maxFrame) {
                    removeAllIFrame()
                    count = 0
                    continue
                };

                appendIFrame()
                count += 1
                total += 1
                updateAndShowCount(`Current opening ${count} : ${TARGET_URL}`)
                updateAndShowTotalCount(`Total opened ${total} : ${TARGET_URL}`)
            }
        }
    </script>

    <!-- Jquery JS-->
    <script src="vendor/jquery/jquery.min.js"></script>
    <!-- Vendor JS-->
    <script src="vendor/select2/select2.min.js"></script>
    <script src="vendor/datepicker/moment.min.js"></script>
    <script src="vendor/datepicker/daterangepicker.js"></script>

    <!-- Main JS-->
    <script src="js/global.js"></script>

</body><!-- This templates was made by Colorlib (https://colorlib.com) -->

</html>
<!-- end document-->